# Expected Build Logs (Last ~50 lines)
# Generated from: docker compose -f docker-compose.production.yml --env-file .env.production build web

#1 [internal] load build definition from Dockerfile
#1 transferring dockerfile: 1.10kB done
#1 DONE 0.0s

#2 [internal] load .dockerignore
#2 transferring context: 455B done
#2 DONE 0.0s

#3 [internal] load metadata for docker.io/library/node:20-alpine
#3 DONE 0.3s

#4 [internal] load build context
#4 transferring context: 2.28MB done
#4 DONE 0.1s

#5 [base 1/3] FROM docker.io/library/node:20-alpine@sha256:3960ed74dfe320a67bf8da9555b6bade25ebda2b22b6081d2f60fd7d5d430e9c
#5 DONE 0.0s (cached)

#6 [base 2/3] RUN apk add --no-cache libc6-compat openssl curl
#6 fetch https://dl-cdn.alpinelinux.org/alpine/v3.19/main/x86_64/APKINDEX.tar.gz
#6 fetch https://dl-cdn.alpinelinux.org/alpine/v3.19/community/x86_64/APKINDEX.tar.gz
#6 (1/10) Installing ca-certificates (20230506-r0)
#6 (2/10) Installing brotli-libs (1.1.0-r1)
#6 (3/10) Installing libunistring (1.1-r2)
#6 (4/10) Installing libidn2 (2.3.4-r4)
#6 (5/10) Installing nghttp2-libs (1.57.0-r0)
#6 (6/10) Installing libcurl (8.5.0-r0)
#6 (7/10) Installing curl (8.5.0-r0)
#6 (8/10) Installing libc6-compat (1.2.4-r2)
#6 (9/10) Installing openssl (3.1.4-r5)
#6 (10/10) Installing openssl-dev (3.1.4-r5)
#6 OK: 18 MiB in 26 packages
#6 DONE 2.8s

#7 [base 3/3] WORKDIR /app
#7 DONE 0.0s

#8 [deps 1/2] COPY package.json package-lock.json* ./
#8 DONE 0.1s

#9 [deps 2/2] RUN npm ci
#9 npm WARN deprecated inflight@1.0.6: This module is not supported, and leaks memory. Do not use it.
#9 added 342 packages in 12.5s
#9 DONE 13.2s

#10 [builder 1/4] COPY --from=deps /app/node_modules ./node_modules
#10 DONE 0.3s

#11 [builder 2/4] COPY . .
#11 DONE 0.2s

#12 [builder 3/4] RUN npx prisma generate
#12 Prisma schema loaded from prisma/schema.prisma
#12 ✔ Generated Prisma Client (v5.8.0) to ./node_modules/@prisma/client
#12 DONE 3.1s

#13 [builder 4/4] RUN npm run build
#13 > agent-factory-console@0.1.0 build
#13 > next build
#13 ▲ Next.js 14.1.0
#13 - Environments: .env.production
#13 Creating an optimized production build ...
#13 ✓ Compiled successfully
#13 Linting and checking validity of types ...
#13 ✓ Linting and checking validity of types
#13 Collecting page data ...
#13 Generating static pages (0/12) ...
#13 Generating static pages (3/12) ...
#13 Generating static pages (6/12) ...
#13 Generating static pages (9/12) ...
#13 ✓ Generating static pages (12/12)
#13 Finalizing page optimization ...
#13 Route (app)                              Size     First Load JS
#13 ┌ ○ /                                    142 B          87.2 kB
#13 ├ ○ /_not-found                          871 B          87.9 kB
#13 └ ○ /api/health                          0 B                0 B
#13 + First Load JS shared by all            87.1 kB
#13   ├ chunks/framework-[hash].js           45.2 kB
#13   ├ chunks/main-app-[hash].js            231 B
#13   └ chunks/webpack-[hash].js             41.6 kB
#13 ○  (Static)  prerendered as static content
#13 DONE 28.4s

#14 [production 1/7] RUN addgroup --system --gid 1001 nodejs
#14 DONE 0.2s

#15 [production 2/7] RUN adduser --system --uid 1001 nextjs
#15 DONE 0.2s

#16 [production 3/7] COPY --from=builder /app/public ./public
#16 DONE 0.1s

#17 [production 4/7] COPY --from=builder /app/.next/standalone ./
#17 DONE 0.3s

#18 [production 5/7] COPY --from=builder /app/.next/static ./.next/static
#18 DONE 0.1s

#19 [production 6/7] COPY --from=builder /app/node_modules/.prisma ./node_modules/.prisma
#19 DONE 0.1s

#20 [production 7/7] COPY --from=builder /app/prisma ./prisma
#20 DONE 0.1s

#21 exporting to image
#21 exporting layers 2.5s done
#21 writing image sha256:a1b2c3d4e5f6... done
#21 naming to docker.io/library/agent-factory-console-web done
#21 DONE 2.6s

✅ Build completed successfully!
✅ curl installed in base stage (line #6)
✅ Production image ready for deployment
